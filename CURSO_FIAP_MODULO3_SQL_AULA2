CREATE TABLE [teste].[dbo].[FIAP]
(
CODIGO INT ,
NOME CHAR(10)
);
DROP TABLE [teste].[dbo].[FIAP];
-- 1 cadastro
INSERT INTO [teste].[dbo].[FIAP]
VALUES (NULL, NULL);
-- 2 cadastro
INSERT INTO [teste].[dbo].[FIAP]
VALUES (1020, 'ANTONIO');

-- NOT NULL 
-- NÃO APARECE NA TABELA DE RESTRIÇÕES, APENAS COMO PROPRIEDADE(CONFIRMAR)
--EXEMPLO DE CONSTRAINT NOT NULL 
create table [teste].[dbo].[FIAP]
(
CODIGO INT CONSTRAINT NN_TESTE_DBO_FIAP_CODIGO  NOT NULL ,
NOME CHAR(10)CONSTRAINT NN_TESTE_DBO_FIAP_CODIGO NOT NULL 
);

-- CODIGO PARA VISUALIZAR A TABELA CONSTRAINTS - VIEW
SELECT TOP 1000 [CONSTRAINT_CATALOG]
      ,[CONSTRAINT_SCHEMA]
      ,[CONSTRAINT_NAME]
      ,[TABLE_CATALOG]
      ,[TABLE_SCHEMA]
      ,[TABLE_NAME]
      ,[CONSTRAINT_TYPE]
      ,[IS_DEFERRABLE]
      ,[INITIALLY_DEFERRED]
  FROM [teste].[INFORMATION_SCHEMA].[TABLE_CONSTRAINTS]

--EXEMPLO CONSTRAINT UNIQUE
CREATE TABLE [teste].[dbo].[FIAP_ALUNO]
(
CODIGO INT CONSTRAINT NN_TESTE_DBO_ALUNO_CODIGO  NOT NULL ,
NOME CHAR(10)CONSTRAINT NN_TESTE_DBO_ALUNO_NOME UNIQUE 
);
--1 VALOR
INSERT INTO [teste].[dbo].[FIAP_ALUNO]
VALUES (1010,'PITOL')
--2 VALOR
INSERT INTO  [teste].[dbo].[FIAP_ALUNO]
VALUES (1010,'PITOL')

--EXEMPLO CONSTRAINT UNIQUE - NIVEL DA TABELA
create table [teste].[dbo].[FIAP_ALUNO2]
(
CODIGO INT CONSTRAINT NN_TESTE_DBO_ALUNO_CODIGO  NOT NULL ,
NOME CHAR(10),
CONSTRAINT NN_TESTE_DBO_ALUNO2_NOME UNIQUE (CODIGO) -- DEVE DECLARAR QUE COLUNA IRÁ RECEBER A CONSTRAINT
);
--1 VALOR
INSERT INTO [teste].[dbo].[FIAP_ALUNO]
VALUES (1010,'PITOL')
--2 VALOR
INSERT INTO  [teste].[dbo].[FIAP_ALUNO]
VALUES (1010,'PITOL')

--EXEMPLO CONSTRAINT PRIMARY_KEY -- IDENTIFICA EXCLUSIVAMENTE CADA REGISTRO DE UMA TABELA -- NÃO ACEITA VALOR NULO
CREATE TABLE [TESTE].[DBO].[FIAP_CHAVE_PRIMARIA]
(
CODIGO INT CONSTRAINT PK_FIAP_CHAVE_PRIMARIA_CODIGO PRIMARY KEY,
NOME CHAR(10)
);
INSERT INTO [TESTE].[DBO].[FIAP_CHAVE_PRIMARIA]
VALUES (1010, 'BATMAN')
-- ERRO VALOR CODIGO REPETIDO - 1010
INSERT INTO [TESTE].[DBO].[FIAP_CHAVE_PRIMARIA]
VALUES (1010, 'SUPERMAN')
-- ERRO VALOR NULL - NULL
INSERT INTO [TESTE].[DBO].[FIAP_CHAVE_PRIMARIA]
VALUES (NULL, 'SPIDER-MAN')

--EXEMPLO CONSTRAINT PRIMARY_KEY (NIVEL DA TABELA) -- IDENTIFICA EXCLUSIVAMENTE CADA REGISTRO DE UMA TABELA -- NÃO ACEITA VALOR NULO
CREATE TABLE [TESTE].[DBO].[FIAP_CHAVE_PRIMARIA2]
(
CODIGO INT ,
NOME CHAR(10),
CONSTRAINT PK_FIAP_CHAVE_PRIMARIA2_CODIGO_NOME PRIMARY KEY (CODIGO,NOME)-- DEVE DECLARAR QUE COLUNA IRÁ RECEBER A CONSTRAINT
-- NO CASO DE USAR UMA CHAVE COMPOSTA DE DOIS OUS MAIS ELEMENTOS, DEVE SEMPRE USAR A COSNTRAINT NO NIVEL DA TABELA
);

INSERT INTO [TESTE].[DBO].[FIAP_CHAVE_PRIMARIA2]
VALUES (1010, 'BATMAN')
-- ERRO VALOR CODIGO REPETIDO - 1010
INSERT INTO [TESTE].[DBO].[FIAP_CHAVE_PRIMARIA2]
VALUES (1010, 'SUPERMAN')
-- ERRO VALOR NULL - NULL
INSERT INTO [TESTE].[DBO].[FIAP_CHAVE_PRIMARIA2]
VALUES (NULL, 'SPIDER-MAN')
--ERRO NOME REPETIDO - SUPERMAN
INSERT INTO [TESTE].[DBO].[FIAP_CHAVE_PRIMARIA2]
VALUES (1010, 'SUPERMAN')
-- ERRO VALOR NULL - NULL

-- APAGAR
DROP TABLE [TESTE].[DBO].[FIAP_CHAVE_PRIMARIA2]

-- EXEMPLO DE CONSTRAINT CHECK
CREATE TABLE [TESTE].[DBO].[ALUNO3]
(
CODIGO INT CONSTRAINT PK_ALUNO3_CODIGO PRIMARY KEY,
NOME CHAR(10) CONSTRAINT NN_ALUNO3_NOME NOT NULL,
SEXO CHAR(1) CONSTRAINT CK_ALUNO3_SEXO CHECK (SEXO IN ('M','F'))
)
--EXEMPLO DE VALORES
INSERT INTO [TESTE].[DBO].[ALUNO3]
VALUES (10,'PAULO','M')
--EXEMPLO DE VALORES ERRO CHECK
INSERT INTO [TESTE].[DBO].[ALUNO3]
VALUES (11,'JOANA','X')

--EXEMPLO DE CONSTRAINT FOREINGN KEY
--SÃO BASEADAS NOS VALORES DOS DADOS , SENDO MA RELAÇÃO LÓGICA E NÃO FÍSICA
--ESSA RESTRIÇÃO PODE SER DEFINIDA NO NÍVEL DA COLUNA OU NO DA TABELA

CREATE TABLE [TESTE].[DBO].[ALUNO_FIAP] 
(
CODIGO INT CONSTRAINT PK_ALUNO_FIAP_CODIGO PRIMARY KEY,
NOME VARCHAR(10) CONSTRAINT NN_ALUNO_FIAP_NOME NOT NULL,
CURSO INT CONSTRAINT FK_ALUNO_FIAP_CURSO_FIAP_CODIGO REFERENCES [TESTE].[DBO].[CURSO_FIAP] (CODIGO)
)
 DROP TABLE [TESTE].[DBO].[ALUNO_FIAP] 

CREATE TABLE [TESTE].[DBO].[CURSO_FIAP]
(
CODIGO INT CONSTRAINT PK_CURSO_FIAP_CODIGO PRIMARY KEY,
NOME VARCHAR(100)
)
--INSERINDO VALORES DENTRO DE CURSO_FIAP
INSERT INTO [TESTE].[DBO].[CURSO_FIAP]
VALUES (1,'BI')

--INSERINDO VALORES DENTRO DE CURSO_FIAP
INSERT INTO [TESTE].[DBO].[CURSO_FIAP]
VALUES (2,'SQL')

--INSERINDO VALORES DENTRO DE ALUNO_FIAP
INSERT INTO [TESTE].[DBO].[ALUNO_FIAP]
VALUES (1010,'STEVE',1)--REFENCIANDO O VALOR DO CURSO

--EXEMPLO DE ERRO --REFENCIANDO O VALOR DO CURSO
INSERT INTO [TESTE].[DBO].[ALUNO_FIAP]
VALUES (1010,'TASSIA',4)
--MENSAGEM 
--Msg 2627, Level 14, State 1, Line 145
--Violation of PRIMARY KEY constraint 'PK_ALUNO_FIAP_CODIGO'. 
--Cannot insert duplicate key in object 'dbo.ALUNO_FIAP'. The duplicate key value is (1010).
--The statement has been terminated.
